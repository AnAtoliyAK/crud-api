(()=>{"use strict";var e={89:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ApiMethods=t.ApiPath=void 0,(t.ApiPath||(t.ApiPath={})).API_USERS="/api/users",(n=t.ApiMethods||(t.ApiMethods={})).GET="GET",n.POST="POST",n.DELETE="DELETE",n.PUT="PUT"},799:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(147),s=r(n(17)),a=n(21),d=(process.env.PORT,(0,o.readFileSync)(s.default.join(__dirname,"./data.json"),"utf-8"));let u=JSON.parse(d);t.default=class{static getUsers(){return i(this,void 0,void 0,(function*(){return new Promise(((e,t)=>e(u)))}))}static getUser(e){return i(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const i=u.find((t=>t.id===e));i?t(i):n(`user with id ${e} not found `)}))}))}static createUser(e){return i(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const{age:i,username:r,hobbies:o}=e;"number"==typeof i&&"string"==typeof r&&Array.isArray(o)?t(Object.assign(Object.assign({},e),{id:(0,a.v4)()})):(i&&"number"==typeof i||n("age field is required and should be number"),r&&"string"!=typeof r||n("age field is required and should be string"),o&&!Array.isArray(o)||n("age field is required and should be Array"))}))}))}static updateUser(e,t){return i(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{u.find((e=>e.id===t))||i(`No user with id ${e.id} found`),n(Object.assign(Object.assign({},e),{id:t}))}))}))}static deleteUser(e){return i(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{u.find((t=>t.id===e))||n(`No user with id ${e} found`),t("user deleted successfully")}))}))}}},341:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(685)),s=n(89),a=r(n(799)),d=r(n(530)),u=n(147),l=r(n(17)),c=r(n(39)),f=process.env.PORT||5e3,p=(0,u.readFileSync)(l.default.join(__dirname,"./data.json"),"utf-8");let y=JSON.parse(p);o.default.createServer(((e,t)=>i(void 0,void 0,void 0,(function*(){var n,i,r,o,f,p;if(e.url===s.ApiPath.API_USERS&&"GET"===e.method){const e=yield a.default.getUsers();t.writeHead(200,{"Content-Type":"application/json"}),t.end(JSON.stringify(e))}else if(null===(n=null==e?void 0:e.url)||void 0===n?void 0:n.includes(s.ApiPath.API_USERS+"/")){const n=null===(i=null==e?void 0:e.url)||void 0===i?void 0:i.split("/")[3];(0,c.default)(n)||(t.writeHead(400,{"Content-Type":"application/json"}),t.end("You should use uuid for id"))}else if((null===(r=null==e?void 0:e.url)||void 0===r?void 0:r.includes(s.ApiPath.API_USERS+"/"))&&e.method===s.ApiMethods.GET){const n=null===(o=null==e?void 0:e.url)||void 0===o?void 0:o.split("/")[3];try{const e=yield a.default.getUser(n);t.writeHead(200,{"Content-Type":"application/json"}),t.end(JSON.stringify(e))}catch(e){t.writeHead(404,{"Content-Type":"application/json"}),t.end(JSON.stringify({message:e}))}}else if((null===(f=e.url)||void 0===f?void 0:f.includes(s.ApiPath.API_USERS+"/"))&&e.method===s.ApiMethods.DELETE)try{const n=e.url.split("/")[3];let i=yield a.default.deleteUser(n);const r=y.filter((e=>e.id!==n));(0,u.writeFile)(l.default.join(__dirname,"./data.json"),JSON.stringify(r),(e=>{if(e){const e={message:"could not persist data!"};t.writeHead(500,{"Content-Type":"application/json"}),t.end(JSON.stringify(e,null,2))}else t.writeHead(200,{"Content-Type":"application/json"}),t.end(JSON.stringify({message:i}))}))}catch(e){t.writeHead(404,{"Content-Type":"application/json"}),t.end(JSON.stringify({message:e}))}else if((null===(p=e.url)||void 0===p?void 0:p.includes(s.ApiPath.API_USERS+"/"))&&e.method===s.ApiMethods.PUT)try{const n=e.url.split("/")[3],i=yield(0,d.default)(e),r=yield a.default.updateUser(JSON.parse(i),n),o=y.filter((e=>e.id!==n));o.push(r),(0,u.writeFile)(l.default.join(__dirname,"./data.json"),JSON.stringify(o),(e=>{if(e){const e={message:"could not persist data!"};t.writeHead(500,{"Content-Type":"application/json"}),t.end(JSON.stringify(e,null,2))}else t.writeHead(200,{"Content-Type":"application/json"}),t.end(JSON.stringify(r,null,2))}))}catch(e){t.writeHead(404,{"Content-Type":"application/json"}),t.end(JSON.stringify({message:e}))}else if("/api/users"===e.url&&"POST"===e.method)try{const n=yield(0,d.default)(e),i=yield a.default.createUser(JSON.parse(n));y.push(i),(0,u.writeFile)(l.default.join(__dirname,"./data.json"),JSON.stringify(y),(e=>{if(e){const e={message:"could not persist data!"};t.writeHead(500,{"Content-Type":"application/json"}),t.end(JSON.stringify(e,null,2))}else t.writeHead(200,{"Content-Type":"application/json"}),t.end(JSON.stringify(y,null,2))})),t.end(JSON.stringify(i))}catch(e){t.writeHead(404,{"Content-Type":"application/json"}),t.end(JSON.stringify({message:e}))}else t.writeHead(404,{"Content-Type":"application/json"}),t.end(JSON.stringify({message:"Route not found"}))})))).listen(f,(()=>{console.log(`server started on port: ${f}`)}))},530:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new Promise(((t,n)=>{try{let n="";e.on("data",(e=>{n+=e.toString()})),e.on("end",(()=>{t(n)}))}catch(e){n(e)}}))}},39:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UUID_VERSION=void 0;const i=n(21),r=n(21);t.UUID_VERSION=4,t.default=function(e){return(0,r.validate)(e)&&(0,i.version)(e)===t.UUID_VERSION}},21:(e,t,n)=>{n.r(t),n.d(t,{NIL:()=>O,parse:()=>g,stringify:()=>c,v1:()=>h,v3:()=>S,v4:()=>w,v5:()=>_,validate:()=>u,version:()=>P});const i=require("crypto");var r=n.n(i);const o=new Uint8Array(256);let s=o.length;function a(){return s>o.length-16&&(r().randomFillSync(o),s=0),o.slice(s,s+=16)}const d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,u=function(e){return"string"==typeof e&&d.test(e)},l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).substr(1));const c=function(e,t=0){const n=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!u(n))throw TypeError("Stringified UUID is invalid");return n};let f,p,y=0,v=0;const h=function(e,t,n){let i=t&&n||0;const r=t||new Array(16);let o=(e=e||{}).node||f,s=void 0!==e.clockseq?e.clockseq:p;if(null==o||null==s){const t=e.random||(e.rng||a)();null==o&&(o=f=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=p=16383&(t[6]<<8|t[7]))}let d=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:v+1;const l=d-y+(u-v)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||d>y)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");y=d,v=u,p=s,d+=122192928e5;const h=(1e4*(268435455&d)+u)%4294967296;r[i++]=h>>>24&255,r[i++]=h>>>16&255,r[i++]=h>>>8&255,r[i++]=255&h;const g=d/4294967296*1e4&268435455;r[i++]=g>>>8&255,r[i++]=255&g,r[i++]=g>>>24&15|16,r[i++]=g>>>16&255,r[i++]=s>>>8|128,r[i++]=255&s;for(let e=0;e<6;++e)r[i+e]=o[e];return t||c(r)},g=function(e){if(!u(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function m(e,t,n){function i(e,i,r,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof i&&(i=g(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+e.length);if(s.set(i),s.set(e,i.length),s=n(s),s[6]=15&s[6]|t,s[8]=63&s[8]|128,r){o=o||0;for(let e=0;e<16;++e)r[o+e]=s[e];return r}return c(s)}try{i.name=e}catch(e){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}const S=m("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),r().createHash("md5").update(e).digest()})),w=function(e,t,n){const i=(e=e||{}).random||(e.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return c(i)},_=m("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),r().createHash("sha1").update(e).digest()})),O="00000000-0000-0000-0000-000000000000",P=function(e){if(!u(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},147:e=>{e.exports=require("fs")},685:e=>{e.exports=require("http")},17:e=>{e.exports=require("path")}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(341)})();